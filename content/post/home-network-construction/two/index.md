---
title: 家庭网络建设二：完全控制你的网络
slug: home-network-construction-two
description: 本篇是家庭网络建设系列的第二篇，主要介绍如何使用路由器的基本功能来控制你上网的全部环节。本篇会介绍家用路由器都会提供的基础服务，并不限于硬件路由器或是软路由
date: 2021-08-10T15:36:15+08:00
image: 
draft: true
tags:
    - 家庭网络建设
categories:
    - tech
    - share
---

## 概述

整个上网的流程可以分为以下几步：

1. 路由器 PPPoE 拨号获得 ip
2. 路由器通过  DHCP 给下游设备分配 ip 和 DNS 服务器
3. 下游设备请求 DNS 服务器解析网站的 ip 并向该 ip 发起请求

所以要控制上网的整个流程就要设置 PPPoE、DHCP、DNS 这三个服务

## PPPoE

运营商的师傅来装网的时候就会把光猫配置成路由器模式启用 PPPoE 功能，这样你只要将网线插入光猫或者连接光猫的 WiFi（ChinaNet-XXX）就可以上网了。但是运营商送的光猫性能实在是堪忧，我们一般会再买一个无线路由器，这样就会平白多出一层 NAT，不利于玩网游和搭建服务器。所以推荐让装机师傅将光猫设置成桥接模式，然后在路由器的宽带上网界面用装机师傅提供的账号密码进行 PPPoE 拨号

## DHCP

在路由器的 DHCP 页面可以设置动态分配的 ip 范围和给指定的下游设备分配静态 ip，这里给出我的配置：
路由器 ip：192.168.5.1
动态分配的 ip 范围：192.168.5.50~192.168.5.200
192.168.5.200 以后的 ip 留给我的 NAS 服务器使用

## DNS

普通路由器可以设置的东西非常少，一般只有在宽带上网设置里可以配置自定义 DNS 服务器，这里推荐几个 dns 服务商：

国内通用 DNS：

- 阿里 DNS：223.5.5.5
- 114 DNS：114.114.114.114

纯净 DNS：

- 清华 DNS：101.6.6.6（5353 端口）
- 中科大 DNS：202.38.93.153（5353 端口）

国外 DNS：

- Google DNS：8.8.8.8
- Cloudflare DNS：1.1.1.1

因为众所周知的原因以上两个 DNS 没有特殊的网络环境是无法访问的